{% extends 'ogidni/base.html' %}
{% load static %}
{% block body_block %}
    {% if story %}
    <button type="button" class="btn btn-success" href="/ogidni/{{ story.url }}/pdf">Generate PDF</button><hr/>
		<div class="panel panel-default" id="s-panel">
			<div class="panel-heading" id="s-{{ story.id }}">
				<h3 class="panel-title">{{ story.name }} <span class="badge">{{ story.upvotes }} | {{ story.downvotes }}</span></h3>
			</div>
			<div class="panel-body">
				<p>{{ story.text }}<p>
				<div class="well well-sm" style="margin-bottom: 0px;">Submitted by {{ story.author }} on {{ story.postdate }}
					<div class="pull-right">
						<a class="btn btn-success btn-xs" onclick="replyvote(DIR.UP, TYPE.S, {{ story.id }})" role="button">Up <span class="glyphicon glyphicon-chevron-up"></span></a> 
						<a class="btn btn-danger btn-xs" onclick="replyvote(DIR.DOWN, TYPE.S, {{ story.id }})" role="button">Down <span class="glyphicon glyphicon-chevron-down"></span></a> 
						<a class="btn btn-info btn-xs" onclick="replyclick(TYPE.S, {{ story.id }})" role="button">Reply &raquo;</a>
					</div>
				</div>
			</div>
		</div>

		{% if replies %}
			<div class="panel panel-default">
			  <div class="panel-heading">
			  	<h3 class="panel-title">Replies</span></h3>
			  </div>
			  <div class="panel-body" id="r-panel">
				{% for reply in replies %}
					<p>{{ reply.text }}</p>
					<div class="well well-sm" style="margin-bottom: 0px;" id="r-{{ reply.id }}">Posted by {{ reply.user }} on {{ reply.postdate }} <span class="badge">{{ reply.upvotes }} | {{ reply.downvotes }}</span>
						<div class="pull-right">
					    	<a class="btn btn-success btn-xs" onclick="replyvote(DIR.UP, TYPE.R, {{ reply.id }})" role="button">Up <span class="glyphicon glyphicon-chevron-up"></span></a> 
					    	<a class="btn btn-danger btn-xs" onclick="replyvote(DIR.DOWN, TYPE.R, {{ reply.id }})" role="button">Down <span class="glyphicon glyphicon-chevron-down"></span></a> 
					    	<a class="btn btn-info btn-xs" onclick="replyclick(TYPE.R, {{ reply.id }})" role="button">Reply &raquo;</a>
					    </div>
					</div>
					<br/>
				{% endfor %}
		  	  </div>
		    </div>
		{% else %}
		    <div class="well well-sm" style="margin-bottom: 0px;">No replies.</div>
		{% endif %}

    {% else %}
		<div class="panel panel-default">
		  <div class="panel-heading">
		  	<h3>Sorry!</h3>
		  </div>
		  <div class="panel-body">
		    <p>Looks like there's a problem displaying this story, Please try again later!<p>
		  </div>
		</div>
    {% endif %}
{% endblock %}

{% block external_scripts %}
    <script src="{% static 'js/ogidni-ajax.js' %}"></script>
    <script src="{% static 'js/reply-box.js' %}"></script>
{% endblock %}